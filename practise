rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /* ============================
       ğŸ” HELPER FUNCTIONS
    ============================ */
    function isSignedIn() {
      return request.auth != null;
    }

    // Admin via custom claim (RECOMMENDED)
    function isAdmin() {
      return isSignedIn() && (request.auth.token.admin == true || 
      request.auth.token.email == "ownergamebridge@gmail.com");
    }

    function isOwner(uid) {
      return isSignedIn() && request.auth.uid == uid;
    }

    /* ============================
       ğŸ‘¤ USERS
    ============================ */
    match /users/{userId} {

      // Player reads own profile, admin reads all
      allow read: if isOwner(userId) || isAdmin();

      // Create profile on signup
      allow create: if isOwner(userId)
        && request.resource.data.role == "player"
        && !("admin" in request.resource.data);

      // Player may update safe fields only
      allow update: if isOwner(userId)
        && !("role" in request.resource.data)
        && !("admin" in request.resource.data);

      // Admin only
      allow delete: if isAdmin();
    }

    /* ============================
       ğŸ® GAMES (ADMIN OWNED)
    ============================ */
    match /games/{gameId} {

      // Logged-in users can discover games
      allow read: if isSignedIn();

      // Admin controls all game data
      allow create, delete: if isAdmin();

      // Prevent client-side revenue tampering
      allow update: if isAdmin()
        && !("accumulatedRevenue" in request.resource.data);
    }

    /* ============================
       ğŸ“Š EVENTS (IMMUTABLE LOG)
       Ads / Installs / Logins
    ============================ */
    match /events/{eventId} {

      // Admin analytics only
      allow read: if isAdmin();

      // Player can log ONLY their own events
      allow create: if isSignedIn()
        && request.resource.data.userId == request.auth.uid
        && request.resource.data.type in [
          "signup",
          "login",
          "ad_view",
          "install",
          "click",
          "session"
        ]
        // Block revenue injection
        && !("value" in request.resource.data)
        && !("paid" in request.resource.data);

      // Events are write-once
      allow update, delete: if false;
    }


    /* ============================
       ğŸ¯ PLAYER PROGRESS
       (Milestones / Levels)
    ============================ */
    match /playerProgress/{progressId} {

      // Player sees own progress, admin sees all
      allow read: if isAdmin()
        || request.auth.uid == resource.data.userId;

      // Player submits milestone ONCE
      allow create: if isSignedIn()
        && request.resource.data.userId == request.auth.uid
        && request.resource.data.level >= 1
        && request.resource.data.milestonePaid == false;

      // Only Cloud Functions / Admin can mark paid
      allow update: if isAdmin();

      allow delete: if false;
    }

    /* ============================
       ğŸ“ˆ ANALYTICS / AGGREGATES
    ============================ */
    match /analytics/{docId} {
      allow read: if isAdmin();
      allow write: if false;
    }

    /* ============================
       ğŸš« DEFAULT DENY (CRITICAL)
    ============================ */
    match /{document=**} {
      allow read, write: if false;
    }
  }
}









rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /* ============================
       ğŸ” HELPER FUNCTIONS
    ============================ */
    function isSignedIn() {
      return request.auth != null;
    }

    // Admin via custom claim (RECOMMENDED)
    function isAdmin() {
      return isSignedIn() && request.auth.token.admin == true;
    }

    function isOwner(uid) {
      return isSignedIn() && request.auth.uid == uid;
    }

    /* ============================
       ğŸ‘¤ USERS
    ============================ */
    match /users/{userId} {

      // Player reads own profile, admin reads all
      allow read: if isOwner(userId) || isAdmin();

      // Create profile on signup
      allow create: if isOwner(userId)
        && request.resource.data.role == "player"
        && !("admin" in request.resource.data);

      // Player may update safe fields only
      allow update: if isOwner(userId)
        && !("role" in request.resource.data)
        && !("admin" in request.resource.data);

      // Admin only
      allow delete: if isAdmin();
    }

    /* ============================
       ğŸ® GAMES (ADMIN OWNED)
    ============================ */
    match /games/{gameId} {

      // Logged-in users can discover games
      allow read: if isSignedIn();

      // Admin controls all game data
      allow create, delete: if isAdmin();

      // Prevent client-side revenue tampering
      allow update: if isAdmin()
        && !("accumulatedRevenue" in request.resource.data);
    }

    /* ============================
       ğŸ“Š EVENTS (IMMUTABLE LOG)
       Ads / Installs / Logins
    ============================ */
    match /events/{eventId} {

      // Admin analytics only
      allow read: if isAdmin();

      // Player can log ONLY their own events
      allow create: if isSignedIn()
        && request.resource.data.userId == request.auth.uid
        && request.resource.data.type in [
          "signup",
          "login",
          "ad_view",
          "install",
          "click",
          "session"
        ]
        // Block revenue injection
        && !("value" in request.resource.data)
        && !("paid" in request.resource.data);

      // Events are write-once
      allow update, delete: if false;
    }

    /* ============================
       ğŸ¯ PLAYER PROGRESS
       (Milestones / Levels)
    ============================ */
    match /playerProgress/{progressId} {

      // Player sees own progress, admin sees all
      allow read: if isAdmin()
        || request.auth.uid == resource.data.userId;

      // Player submits milestone ONCE
      allow create: if isSignedIn()
        && request.resource.data.userId == request.auth.uid
        && request.resource.data.level >= 1
        && request.resource.data.milestonePaid == false;

      // Only Cloud Functions / Admin can mark paid
      allow update: if isAdmin();

      allow delete: if false;
    }

    /* ============================
       ğŸ“ˆ ANALYTICS / AGGREGATES
    ============================ */
    match /analytics/{docId} {
      allow read: if isAdmin();
      allow write: if false;
    }

    /* ============================
       ğŸš« DEFAULT DENY (CRITICAL)
    ============================ */
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
























â€‹ğŸ® GameBridge â€” Clear & Improved Explanation
â€‹1ï¸âƒ£ What GameBridge Is (Plain English)
â€‹GameBridge is a Progressive Web App (PWA) that:
â€‹Lets users discover and launch games from various studios in one place.
â€‹Monetizes engagement for the platform owner when users:
â€‹Watch featured ads before playing.
â€‹Download full game versions from the Play Store.
â€‹Progress through specific in-game levels.
â€‹Gives you (Owner) full visibility into user actions and revenue generated per studio.
â€‹Gives game studios a secure portal to track their game's performance and pay for the traffic you provide.
â€‹2ï¸âƒ£ User Flow (The Player Experience)
â€‹ğŸ” Step 1: Login / Sign-Up: User enters via Google or Email. Firebase manages their profile and session.
â€‹ğŸ•¹ï¸ Step 2: Discovery Dashboard: The user sees a curated list of games with two main options:
â€‹â–¶ï¸ Button 1: Play Now (with Ad): User watches a featured ad to unlock a web demo or instant play version. You earn ad revenue; the user gets immediate access to the game.
â€‹ğŸ“² Button 2: Get Full App: Redirects the user to the Google Play Store. If they install it, you receive an "Install Attribution" event.
â€‹3ï¸âƒ£ Progress Tracking (For Billing)
â€‹Even though players don't earn rewards, the system tracks their progress to trigger payments from the Studios to You:
â€‹Milestones: When a player reaches a specific level (e.g., Level 10), an event is sent to Firebase.
â€‹Verification: Cloud Functions verify the event is legitimate.
â€‹Billing: This completion is logged as a "Billable Event," meaning the studio now owes you the pre-agreed fee for driving a high-quality player to that depth in their game.
â€‹4ï¸âƒ£ The Admin Portal (Your View)
â€‹You monitor the entire ecosystem:
â€‹ğŸ‘¤ User Activity: Track active players and their engagement history.
â€‹ğŸ“º Ad Analytics: See which games are generating the most ad views.
â€‹ğŸ“¥ Performance Metrics: Total installs and level completions driven by your platform.
â€‹ğŸ’° Balance Sheet: Real-time calculation of exactly how much each studio owes you based on the "Rate Card" you set.
â€‹5ï¸âƒ£ The Studio Portal
â€‹Each studio gets a private dashboard to justify their costs:
â€‹Transparency: They see the exact number of ads played and levels reached.
â€‹Invoicing: They view and pay invoices for the traffic/players you sent them.
â€‹Data Only: They cannot see your other partners or access your administrative settings.
â€‹6ï¸âƒ£ Why GameBridge Is Powerful
â€‹âœ… Platform Control: You decide the value of an install or a level completion.
â€‹âœ… B2B Revenue: Your income comes from professional studios paying for performance, not from managing player payouts.
â€‹âœ… Data Integrity: Every launch and level-up is a hard-coded event, making your billing impossible to dispute.
â€‹âœ… Zero Friction: Works as a PWA; players don't need to install GameBridge itself to start playing.
â€‹7ï¸âƒ£ In One Sentence (Pitch Ready)
â€‹"GameBridge is a Firebase-powered PWA that monetizes game discovery by tracking ad views, installs, and level-based milestonesâ€”providing studios with a transparent, high-performance platform for user acquisition and billing

1ï¸âƒ£ User-Facing Features (Player Dashboard / App)

This is what your players will interact with.

a) Player Dashboard

Library of games: Display demos and full apps, with filtering by studio, category, or popularity.

Skeleton loaders & smooth UX: Loading animations while data is fetched.

Responsive design: Works on desktop and mobile.

Secure login/logout: Firebase Auth (Email/password, optional Google/Apple).

b) Monetization & Tracking

Rewarded Ads (Launch Demo)

Player watches ad â†’ unlocks demo.

Revenue logged to Firestore (per-user, per-game).

Install Attribution / CPI Tracking (Full App)

Clicking Full App redirects to Play/App Store via tracking link.

Install confirmed â†’ revenue logged.

Event logging: Track clicks, ad views, installs, session duration.

c) Progress Tracking

Milestones / Levels: Track which levels/milestones each player completed.

Optional achievements & badges: Gamification layer.

d) User account & profile

View username, email, total ad rewards earned.

Account management (change password, view history).

2ï¸âƒ£ Admin Portal (Web / Dashboard)

Admins need to manage games, track revenue, and view analytics.

a) Game Management

Add / edit / remove games.

Set status: active/inactive.

Set ad payout (adPayout) and install payout (installPayout).

Upload images / thumbnails / categories.

b) Revenue Tracking

View total ad revenue per game & per player.

View install revenue (CPI).

Aggregate analytics: daily/weekly/monthly totals.

c) Player Analytics

Track which players played which demos.

Track level/milestone completion.

Optional: Retention metrics (daily active users, sessions).

d) Admin Tools

Manual override of revenue.

Audit logs: who added/edited/removed a game.

Notifications for errors or suspicious behavior.

3ï¸âƒ£ Backend Requirements (Firebase)

Firebase provides serverless backend. Features needed:

a) Auth

Email/password (mandatory).

Optional OAuth: Google, Apple.

b) Firestore Collections

Collection	Description
games	Stores game info (title, studio, URL, adPayout, installPayout, status, createdAt, accumulatedRevenue)
events	Logs ad views, installs, clicks, and revenue events with userName, gameName, type, value, timestamp
playerProgress	Logs milestones / levels completed by player with milestonePaid flag
users	Optional: extra player data (profile, stats)
analytics	Optional: click tracking, session duration, engagement metrics

c) Security Rules

Players: Read only for active games, write only for their events.

Admins: Full read/write access.

Prevent overwriting revenue or injecting fake events.

d) Cloud Functions (Optional but recommended)

Process deferred installs or track real revenue events from affiliate SDK.

Send notifications to players (optional).

Update accumulatedRevenue automatically on events insertion.

4ï¸âƒ£ Ad & Monetization Integrations

a) Rewarded Ads

SDKs: Tapjoy, AppLovin, IronSource, AdMob.

Player must watch full ad â†’ revenue credited.

Optional: Cap ads per session/day.

b) Install Attribution / CPI

Affiliate SDK or tracking links.

Must confirm install â†’ revenue credited.

Optional: Deep link to store or redirect based on device OS.

c) Analytics & ROI Tracking

Track CTR for Play / Install buttons.

Track ad completions.

Provide per-game revenue reports to studios.














// Import the functions you need from the SDKs you need
import { initializeApp } from "firebase/app";
import { getAnalytics } from "firebase/analytics";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyCLd4MLONU_5OFie6WN2XmXmlMyfuJ5_8I",
  authDomain: "gamebridge-f4789.firebaseapp.com",
  projectId: "gamebridge-f4789",
  storageBucket: "gamebridge-f4789.firebasestorage.app",
  messagingSenderId: "562553872482",
  appId: "1:562553872482:web:02b34e7bc1b7a25af8f13b",
  measurementId: "G-X3B8B4L4XW"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);






âœ… THE ONLY VIABLE PATH FOR YOU (RIGHT NOW)

You must do Affiliate CPI / CPA networks
NOT AdMob alone
NOT studios first
NOT playâ€‘toâ€‘earn

ğŸ‘‰ Affiliate networks are the bridge between â€œuser installs / levelsâ€ and real money.

Your backend is already good enough. You just need to plug into the right money source.

ğŸ”¥ WHAT YOU WILL DO (NO OPTIONS)
STEP 1 â€” CREATE AFFILIATE ACCOUNTS (TODAY)

Go to these sites now and sign up as a publisher:

1ï¸âƒ£ AdGate Media (TOP PRIORITY)

ğŸ‘‰ https://adgatemedia.com

Pays for installs

Pays for inâ€‘app actions (levels, tutorials completed)

Supports Android games

When asked:

Traffic type: Web + Mobile

Monetization: Game installs / rewarded actions

Country: Your real country

2ï¸âƒ£ Tapjoy (SECOND)

ğŸ‘‰ https://www.tapjoy.com

CPI + milestone payouts

Extremely reliable

Used by real studios

Sign up as:

Publisher

NOT advertiser

3ï¸âƒ£ ironSource Offerwall

ğŸ‘‰ https://developers.is.com/ironsource-mobile/offerwall/

Pays for installs + inâ€‘game events

Good fill rate

4ï¸âƒ£ AdGem (Optional but good)

ğŸ‘‰ https://adgem.com/publishers/

âš ï¸ IMPORTANT
These networks:

Pay YOU

You pay NOBODY

Users get nothing

Studios donâ€™t get paid by you

STEP 2 â€” HOW MONEY WILL FLOW (EXACTLY)
User
 â†“
Clicks "Install Game"
 â†“
Redirected to Affiliate Tracking Link
 â†“
Installs game
 â†“
Plays game
 â†“
Completes level / tutorial
 â†“
Affiliate network verifies
 â†“
Affiliate network PAYS YOU


ğŸ”¥ This is how installs & levels become money.

STEP 3 â€” EXACTLY WHAT TO CHANGE IN YOUR APP
ğŸ” Replace Play Store links

âŒ WRONG:

window.location.href = "https://play.google.com/store/apps/details?id=game";


âœ… RIGHT:

window.location.href = affiliateTrackingLink;


Example:

https://tracking.adgatemedia.com/click?offer_id=12345&pub_id=YOUR_ID

ğŸ® Demo Games

When user clicks Play Demo:

Show rewarded ad (AdMob / Unity)

Log event

THEN show demo

During demo:

Every X minutes â†’ show another ad

Demo itself doesnâ€™t pay
Ads inside demo do

ğŸ¯ Level Tracking

You already track levels.

What you do now:

Track levels for verification

DO NOT promise rewards to users

Affiliate SDK verifies progress

STEP 4 â€” ADD SDKs (THIS IS REQUIRED)

You must integrate SDKs for:

Tapjoy

ironSource Offerwall

These SDKs:

Verify installs

Verify level completion

Prevent fraud

ğŸ“Œ Without SDKs â†’ NO MONEY

STEP 5 â€” PAYOUTS (WHERE YOU GET MONEY)

Affiliate networks pay via:

PayPal

Wire

Wise

Crypto (sometimes)

You do:

NOTHING

No payouts

No splits

No rewards


âš ï¸ FIRST: NONâ€‘NEGOTIABLE TRUTH (READ THIS ONCE)

There is NO way to make AdMob / Unity Ads / IronSource / Meta pay for:

installs

levels

demo plays

âŒ Impossible.
No button, no SDK, no backend can change this.

So to turn ALL actions â†’ YES (paid) you must ADD ONE THING:

ğŸ‘‰ Affiliate CPI / CPA networks

This is not optional. This is the only path.

âœ… THE EXACT PATH (FROM WHERE YOU ARE NOW)

You already have:

Firebase

Event tracking

Secure rules

Redirects

Level tracking

You are 80% done.

Now do the following in order.

ğŸ”¥ STEP 1 â€” CREATE MONEY SOURCES (30 minutes)
1ï¸âƒ£ Open this link

ğŸ‘‰ https://adgatemedia.com

2ï¸âƒ£ Click

ğŸŸ¢ â€œSign Upâ€

3ï¸âƒ£ Choose

âœ”ï¸ Publisher

4ï¸âƒ£ Fill the form EXACTLY like this:

Website: https://yourgamebridge.app (or localhost for now)

Traffic type: Web + Android

Monetization: Game installs / rewarded offers

Monthly traffic: estimate (even 1k is fine)

5ï¸âƒ£ Submit & wait for approval

(usually same day)

6ï¸âƒ£ While waiting, open:

ğŸ‘‰ https://www.tapjoy.com

Click Sign Up

Choose Publisher

Platform: Android

Monetization: Offerwall / CPI

ğŸ”¥ STEP 2 â€” GET THE LINKS THAT PAY YOU

After approval:

In AdGate dashboard:

Click Offers

Filter: Android

Choose a game offer

Click Get Tracking Link

You will see something like:

https://tracking.adgatemedia.com/click?offer_id=12345&pub_id=ABCDE


ğŸ‘‰ THIS LINK = MONEY

ğŸ”¥ STEP 3 â€” CHANGE ONE LINE IN YOUR APP (CRITICAL)
âŒ WHAT YOU DO NOW (WRONG)
window.location.href = "https://play.google.com/store/apps/details?id=com.game";

âœ… WHAT YOU MUST DO (RIGHT)
window.location.href = "https://tracking.adgatemedia.com/click?offer_id=12345&pub_id=ABCDE";


ğŸ“Œ This is what makes:

Install = PAID

Level completion = PAID

Tutorial completion = PAID

ğŸ”¥ STEP 4 â€” MAKE LEVELS PAY YOU

You do NOT pay users
You do NOT show earnings

What happens instead:

User installs via affiliate link

User opens game

User reaches required level (e.g. Level 5)

Affiliate SDK detects it

Affiliate network credits YOU

ğŸ”¥ You already track levels â€” good.

Now install ONE SDK.

ğŸ”¥ STEP 5 â€” INSTALL SDK (DO THIS)
Choose ONE first (Tapjoy is easiest)

ğŸ‘‰ https://dev.tapjoy.com/en/android-sdk/

What you do:

Open Android Studio

Add Tapjoy SDK

Initialize SDK on app launch

Done

Tapjoy handles:

install verification

level verification

fraud protection

payout

Your backend stays untouched.

ğŸ”¥ STEP 6 â€” MAKE DEMO PLAYS PAY YOU

Demo plays never pay directly
So you do this instead:

Demo Flow (DO EXACTLY THIS):

User clicks Play Demo

Show Rewarded Ad

Log ad_view

Start demo

Every 2â€“3 minutes â†’ show interstitial ad

ğŸ”¥ Demo = ad container = money

ğŸ”¥ STEP 7 â€” STACK ADS (NOW EVERYTHING IS PAID)
Action	How it pays
Ad watched	AdMob / Unity
Ad clicked	AdMob / Unity
Game installed	Affiliate CPI
Level reached	Affiliate CPA
Demo played	Ads inside demo

âœ… ALL ACTIONS = YES (PAID)







